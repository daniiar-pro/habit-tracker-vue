import{d as $,r as c,w as I,c as o,a as t,F as V,b as B,o as s,n as w,t as O,_ as E,e as j,f,g as G,h as Y,i as q,j as N,v as T,k as J,u as P,l as Q,m as X}from"./index-CF_Wg9Y0.js";import{l as Z,d as H,g as k,s as C,h as ee,a as te,b as ae,t as le}from"./localStorage-BB28ZdN7.js";const se={class:"current-week"},oe={class:"navigation-days"},ne=["onClick"],ie=$({__name:"CurrentWeek",props:{selectedDate:{}},emits:["update-day-selected"],setup(D,{emit:_}){const y=c(["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]),v=new Date,r=c((v.getDay()+6)%7),l=c(r.value),n=D,p=_;I(()=>n.selectedDate,b=>{const m=new Date(b);if(isNaN(m.getTime()))return;const h=Math.round((m.setHours(0,0,0,0)-v.setHours(0,0,0,0))/(1e3*60*60*24));l.value=(r.value+h+7)%7},{immediate:!0});function i(b){l.value=b;const m=new Date,h=b-r.value;m.setDate(v.getDate()+h),p("update-day-selected",m.toISOString().slice(0,10))}return(b,m)=>(s(),o("div",se,[t("div",oe,[(s(!0),o(V,null,B(y.value,(h,u)=>(s(),o("span",{key:u,class:w({selected:u===l.value}),onClick:M=>i(u)},O(h),11,ne))),128))])]))}}),ue=E(ie,[["__scopeId","data-v-ab77e4c1"]]),de={class:"habit-item"},ce={key:0,style:{color:"lightblue","font-size":"0.9rem"}},re=["checked","disabled"],pe=["disabled"],ve={key:0},be={key:1,style:{color:"lightgrey"}},me=$({__name:"HabitItem",props:{title:{},completed:{type:Boolean},stopped:{type:Boolean},isFutureDate:{type:Boolean}},emits:["delete-habit","edit-habit","toggle-completed","stop-habit"],setup(D,{emit:_}){const y=D,v=_;function r(){v("toggle-completed",y.title)}function l(){v("delete-habit",y.title)}function n(){v("stop-habit",y.title)}function p(){v("edit-habit")}return(i,b)=>(s(),o("div",de,[t("h3",null,[j(O(i.title)+" ",1),i.stopped?(s(),o("i",ce,"(stopped habit)")):f("",!0)]),i.stopped?f("",!0):(s(),o("input",{key:0,type:"checkbox",checked:i.completed,disabled:i.isFutureDate,onChange:r},null,40,re)),i.stopped?f("",!0):(s(),o("button",{key:1,class:"edit-btn",onClick:p},"Edit")),t("button",{class:"delete-btn",onClick:l},"Delete"),t("button",{class:"stop-btn",disabled:i.stopped,onClick:n},[i.stopped?(s(),o("span",be,"Stopped")):(s(),o("span",ve,"Stop"))],8,pe)]))}}),he=E(me,[["__scopeId","data-v-e648b975"]]),fe={class:"habits-list"},ye={class:"habits-container"},_e={key:0,class:"modal-overlay"},ge={class:"modal"},ke={key:0,class:"error-message"},De={key:1,class:"modal-overlay"},Se={class:"modal"},He={key:0,class:"error-message"},Ce={key:2,class:"modal-overlay"},we=$({__name:"HabitsView",setup(D){const _=P(),y=Q(),v=te,r=c(""),l=c(new Date().toISOString().slice(0,10)),n=c([]),p=c(null),i=c(null),b=c(!1),m=c(!1),h=c(!1),u=c(!1);G(()=>{Z();const e=_.params.date||new Date().toISOString().slice(0,10);H.value[e]||(H.value[e]=k(e)),l.value=e,n.value=H.value[e]}),I(()=>_.params.date,a=>{if(typeof a=="string"&&!isNaN(Date.parse(a))){const e=new Date(a).toISOString().slice(0,10);l.value=e,n.value=k(e)}else{console.warn(`Invalid or missing date in route.params.date: ${a}`);const e=new Date().toISOString().slice(0,10);l.value=e,n.value=k(e)}},{immediate:!0});function M(a){l.value=a,n.value=k(a),y.push({name:"Habits",params:{date:a}})}const A=Y(()=>{const a=new Date().toISOString().slice(0,10);return l.value>a});function z(){b.value=!0,u.value=!1}function U(a){p.value=a,m.value=!0}function W(a){i.value=a,h.value=!0}function g(){b.value=!1,m.value=!1,h.value=!1}function F(){if(!r.value.trim()){u.value=!0;return}const a={title:r.value.trim(),completed:!1,date:l.value};v.value.push(a),n.value.push(a),r.value="",u.value=!1,C(),g()}function x(){var a;if(!((a=p.value)!=null&&a.title.trim())){u.value=!0;return}n.value=n.value.map(e=>e.title===p.value.title?p.value:e),C(),g()}function K(){ee(i.value.title,l.value),g()}function L(a){ae(a),n.value=k(l.value),C()}function R(a){le(l.value,a),n.value=k(l.value)}return(a,e)=>(s(),o("div",fe,[e[6]||(e[6]=t("h1",{style:{"text-align":"center",color:"black"}},"Current week",-1)),q(ue,{onUpdateDaySelected:M,selectedDate:l.value},null,8,["selectedDate"]),e[7]||(e[7]=t("br",null,null,-1)),t("div",ye,[(s(!0),o(V,null,B(n.value,d=>(s(),X(he,{key:d.title,title:d.title,completed:d.completed,stopped:d.stopped,isFutureDate:A.value,onEditHabit:S=>U(d),onDeleteHabit:S=>L(d.title),onToggleCompleted:S=>R(d.title),onStopHabit:S=>W(d)},null,8,["title","completed","stopped","isFutureDate","onEditHabit","onDeleteHabit","onToggleCompleted","onStopHabit"]))),128))]),t("div",{class:"add-habit"},[t("button",{onClick:z},"Add new habit")]),b.value?(s(),o("div",_e,[t("div",ge,[e[2]||(e[2]=t("h3",null,"Add New Habit",-1)),N(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=d=>r.value=d),class:w({"input-invalid":u.value}),placeholder:"Enter habit title",onKeyup:J(F,["enter"])},null,34),[[T,r.value]]),u.value?(s(),o("span",ke,"Habit title cannot be empty")):f("",!0),t("div",{class:"modal-buttons"},[t("button",{onClick:F},"Add Habit"),t("button",{onClick:g,class:"cancel-button"},"Cancel")])])])):f("",!0),m.value&&p.value?(s(),o("div",De,[t("div",Se,[e[3]||(e[3]=t("h3",null,"Edit Habit",-1)),N(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=d=>p.value.title=d),class:w({"input-invalid":u.value}),placeholder:"Edit habit title"},null,2),[[T,p.value.title]]),u.value?(s(),o("span",He,"Habit title cannot be empty")):f("",!0),t("div",{class:"modal-buttons"},[t("button",{onClick:x},"Save Changes"),t("button",{onClick:g,class:"cancel-button"},"Cancel")])])])):f("",!0),h.value?(s(),o("div",Ce,[t("div",{class:"modal"},[e[4]||(e[4]=t("h3",null,"Stop Habit",-1)),e[5]||(e[5]=t("p",null,"Are you sure you want to stop tracking this habit?",-1)),t("div",{class:"modal-buttons"},[t("button",{onClick:K},"Yes, Stop"),t("button",{onClick:g,class:"cancel-button"},"Cancel")])])])):f("",!0)]))}}),Me=E(we,[["__scopeId","data-v-b02bcf95"]]);export{Me as default};
